(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{17:function(t,e,a){"use strict";var i=a(3);a.n(i).a},3:function(t,e,a){},37:function(t,e,a){"use strict";var i=a(4);a.n(i).a},38:function(t,e,a){"use strict";var i=a(5);a.n(i).a},39:function(t,e,a){"use strict";var i=a(6);a.n(i).a},4:function(t,e,a){},40:function(t,e,a){"use strict";var i=a(7);a.n(i).a},42:function(t,e,a){"use strict";a.r(e);var i=a(2);var n=function(t,e,a){var i,n,s,o,l,r={top:0,right:0,bottom:0,left:0};return n=e,"[object Object]"===Object.prototype.toString.call(n)?(a=e,e=null):a||(a={}),Object.assign(r,a),(i=e?e.getBoundingClientRect():{top:0,right:window.innerWidth||document.documentElement.clientWidth,bottom:window.innerHeight||document.documentElement.clientHeight,left:0}).top-=r.top,i.right+=r.right,i.bottom+=r.bottom,i.left-=r.left,s=t.getBoundingClientRect(),o=i,(l={}).top=Math.max(s.top,o.top),l.bottom=Math.min(s.bottom,o.bottom),l.left=Math.max(s.left,o.left),l.right=Math.min(s.right,o.right),l.bottom>=l.top&&l.right>=l.left};var s={name:"vue-lazy-waterfall",data:function(){return{maxHeight:0,isFinished:!1,beginIndex:0,showItems:[],loadings:0,isLoading:!1,isEnd:!1,lazyRenderItems:[]}},props:{items:{type:Array,required:!0},colNum:{type:Number,default:5},width:{type:Number,default:function(){return window.innerWidth}},itemWidth:{type:Number,default:function(){return parseInt(this.width/this.colNum)}},load:Function,createLazyLoader:Function,diff:{type:Object,default:function(){return{bottom:window.innerHeight||document.documentElement.clientHeight}}},autoMode:{type:Boolean,default:!0},maxLoading:{type:Number,default:2},imageFilter:Function},watch:{items:function(){this.renderView()},colNum:function(){this.reflow(this.showItems)}},mounted:function(){this.renderView(),this.bindEvents(),this.createLazyloadCallback()},beforeDestroy:function(){this.unbindEvents()},methods:{bindEvents:function(){this.$on("preloaded",this.preloadedHandler)},renderView:function(){this.isEnd||this.calcItemsStyle()},scrollHandler:function(){!this.isEnd&&this.canLoadData()&&n(this.$refs.loadRef,this.diff)&&this.$emit("load")},reflow:function(t){var e=this;t.forEach(function(t){e.calcItemStyle(t)});var a=0;t.forEach(function(t){var i=t._index,n=e.$refs["$el_".concat(i)][0];n.style.cssText+="left:".concat(t._style.left,";top:").concat(t._style.top,";"),a=Math.max(a,parseInt(t._style.top)+n.offsetHeight)}),this.maxHeight=a},createLazyloadCallback:function(){var t,e,a;this.createLazyLoader?this.createLazyLoader(this.$refs.loadRef):(this.lazyScrollHandler=(t=this.scrollHandler,e=(e=50)||50,function(){var i=+new Date;(!a||i-a>=e)&&(a=i,t())}),window.addEventListener("scroll",this.lazyScrollHandler.bind(this)))},preloadedHandler:function(t){this.reflow(t),this.lazyScrollHandler&&this.lazyScrollHandler()},unbindEvents:function(){this.lazyScrollHandler&&window.removeEventListener("scroll",this.lazyScrollHandler),this.$off("preloaded",this.preloadedHandler)},canLoadData:function(){return this.loadings<this.maxLoading},calcItemStyle:function(t){var e=this.colNum,a=t._index,i=a%e*this.itemWidth,n=0,s=a-e;if(s>=0){var o=this.$refs["$el_".concat(s)];if(o=o&&o[0]){var l=this.showItems[s];n=parseInt(l._style.top)+o.offsetHeight}}t._style={width:"".concat(this.itemWidth,"px"),left:"".concat(i,"px"),top:"".concat(n,"px")}},lazyRenderItemsHandler:function(){var t=this,e=this.lazyRenderItems[0];e&&e.len===e.count&&(this.showItems=this.showItems.concat(e.items),this.$nextTick(function(){t.lazyRenderItems.shift(),t.lazyRenderItemsHandler(),t.$emit("preloaded",e.items)}))},calcItemsStyle:function(){var t=this,e=this,a=this.beginIndex,i=this.items,n=i.length,s=this.autoMode,o={count:0,len:n-a,items:i.slice(a,n)},l="function"==typeof this.imageFilter;if(o.len){s||this.lazyRenderItems.push(o),this.loadings++;var r=function(a){return function(i){i&&(a.$event=i,a._isLoadImageError="error"===i.type,e.$emit("image-".concat(i.type),a)),o.count+=1,s?(a._index=e.showItems.length,e.calcItemStyle(a),e.showItems.push(a),e.$nextTick(function(){e.resetMaxHeight(a)})):e.calcItemStyle(a),o.count===o.len&&(t.isLoading=!1,s||e.lazyRenderItemsHandler(),e.loadings--,0===e.loadings&&e.$emit("finished"),e.$emit("done",o.items))}};o.items.forEach(function(e,i){var n=new Image;e._index=i+a,e.src?(n.onload=r(e),n.onerror=r(e),n.src=l?t.imageFilter(e.src,e):e.src):r(e)}),e.beginIndex=n}},resetMaxHeight:function(t){var e=t._index,a=this.$refs["$el_".concat(e)][0];this.maxHeight=Math.max(this.maxHeight,parseInt(t._style.top)+a.offsetHeight)},end:function(){var t=this;this.loadings?this.$once("finished",function(){t.isFinished=!0}):this.isFinished=!0,this.isEnd=!0,this.unbindEvents()},clickItemHandler:function(t,e,a){this.$emit("click",{value:t,index:e,$event:a})}}},o=(a(17),a(1)),l=Object(o.a)(s,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"vue-lazy-waterfall-wrap",style:{width:t.width+"px"}},[a("ul",{ref:"listRef",staticClass:"vue-lazy-waterfall-list",style:{"padding-top":t.maxHeight+"px"}},[t._l(t.showItems,function(e,i){return a("li",{key:i,ref:"$el_"+i,refInFor:!0,staticClass:"vue-lazy-waterfall-item",style:e._style,on:{click:function(a){t.clickItemHandler(e,i,a)}}},[t._t("default",null,{item:e})],2)}),t._v(" "),a("li",{directives:[{name:"show",rawName:"v-show",value:!1===t.isFinished,expression:"isFinished===false"}],ref:"loadRef",staticClass:"loading-placeholder"},[t._t("loading")],2)],2),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.isFinished,expression:"isFinished"}],staticClass:"vue-lazy-waterfall-end"},[t._t("endToBottom")],2)])},[],!1,null,"aaba10dc",null);l.options.__file="index.vue";var r=l.exports,d=a(9),c=a.n(d),h={name:"app",data:()=>({}),components:{vueLazyWaterfall:r},methods:{backToTopHandler(){window.scrollTo(0,0)}}},m=(a(37),Object(o.a)(h,function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("router-view"),this._v(" "),e("div",{staticClass:"back-top",on:{click:this.backToTopHandler}},[this._v("back to top")]),this._v(" "),e("div",{staticStyle:{height:"3000px","background-color":"#00C075"}})],1)},[],!1,null,null,null));m.options.__file="App.vue";var u=m.exports,f=a(10),p={name:"app",data:()=>({items:[],group:0,width:990}),components:{vueLazyWaterfall:r},methods:{loadData(){c.a.get("./static/mock/data.json?group="+this.group).then(t=>{this.group++,this.group>20?this.$refs.waterfall.end():(t.data.sort(()=>Math.random()-.5),this.items=this.items.concat(t.data))})},clickFn({value:t,index:e,$event:a}){},imageLoad({$event:t}){}},created(){this.loadData()}},v=(a(38),Object(o.a)(p,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("vueLazyWaterfall",{ref:"waterfall",staticClass:"waterfall-wrap",attrs:{items:t.items,width:t.width,diff:{bottom:2e3}},on:{load:t.loadData,"image-load":t.imageLoad,"image-error":t.imageLoad,click:t.clickFn},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.item;return a("div",{staticClass:"pin-item"},[a("img",{attrs:{src:i.src,alt:""}}),t._v("\n      "+t._s(i.textContent)+"\n    ")])}}])},[a("div",{staticClass:"loading-spinner",attrs:{slot:"loading"},slot:"loading"}),t._v(" "),a("div",{staticClass:"end-tip",attrs:{slot:"endToBottom"},slot:"endToBottom"},[t._v("end...")])])],1)},[],!1,null,null,null));v.options.__file="basic-app.vue";var g=v.exports,w=a(16),y=a.n(w),_={name:"waterfall-lazy-app",data:()=>({items:[],page:0}),components:{vueLazyWaterfall:r},methods:{loadData(){return this.mockPageData().then(t=>{this.items=this.items.concat(t),this.page++,20===this.page&&this.$refs.waterfall.end()})},mockPageData(){for(var t=[],e=0;e<20;e++){let e=parseInt(100*Math.random())+300,a=parseInt(100*Math.random())+300;t.push({src:`https://picsum.photos/${e}/${a}/?random`,info:+new Date})}return Promise.resolve(t)},createLazyLoader(t){const e=this,a=y()(t,{load:function(){e.loadData()},loaded(){e.$refs.waterfall.$on("preloaded",()=>{console.log("load next"),t.dataset.loaded=!1,a.observe(t)})},rootMargin:"500px",threshold:1});a.observe()}}},b=(a(39),Object(o.a)(_,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wrap"},[a("vueLazyWaterfall",{ref:"waterfall",attrs:{items:t.items,width:1190,createLazyLoader:t.createLazyLoader},on:{load:t.loadData},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.item;return[a("div",{staticClass:"pin-item"},[a("img",{attrs:{src:i.src,alt:""}}),t._v(" "),a("p",[t._v(t._s(i.info))])])]}}])},[a("div",{staticClass:"loading-spinner",attrs:{slot:"loading"},slot:"loading"}),t._v(" "),a("template",{slot:"endToBottom"},[a("div",{staticClass:"end-tip"},[t._v("it is end...")])])],2)],1)},[],!1,null,null,null));b.options.__file="lazy-app.vue";var I=b.exports,x={name:"image-list-page",data(){var t=.85*window.innerWidth,e=parseInt(t/200);return{items:[],group:0,width:200*e,colNum:e,itemWidth:200}},components:{VueLazyWaterfall:r},mounted(){this.bindEvents()},beforeDestroy(){window.removeEventListener("resize",this.resizeHandler)},methods:{bindEvents(){window.addEventListener("resize",this.resizeHandler)},resizeHandler(){var t=parseInt(.8*window.innerWidth);this.colNum=parseInt(t/this.itemWidth),this.width=this.itemWidth*this.colNum},getData(){this.mockPageData().then(t=>{this.items=this.items.concat(t),this.group++,20===this.group&&this.$refs.waterfall.end()})},mockPageData(){for(var t=[],e=0;e<20;e++){let e=parseInt(100*Math.random())+300,a=parseInt(100*Math.random())+300;Math.min(parseInt(15*Math.random())+1,15);t.push({src:`https://picsum.photos/${e}/${a}/?random`,info:+new Date})}return Promise.resolve(t)},clickImgHandler(){console.log(arguments)}},created(){this.getData()}},z=(a(40),Object(o.a)(x,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"freelog-alpha-images-list"},[a("VueLazyWaterfall",{ref:"waterfall",attrs:{items:t.items,colNum:t.colNum,autoMode:!1,itemWidth:t.itemWidth,width:t.width},on:{click:t.clickImgHandler,load:t.getData},scopedSlots:t._u([{key:"default",fn:function(t){var e=t.item;return a("div",{directives:[{name:"show",rawName:"v-show",value:!1===e._isLoadImageError,expression:"item._isLoadImageError === false"}],staticClass:"pin-image-item"},[a("img",{attrs:{src:e.src,alt:""}})])}}])},[a("div",{staticClass:"loading-spinner",attrs:{slot:"loading"},slot:"loading"}),t._v(" "),a("div",{staticClass:"end-tip",attrs:{slot:"endToBottom"},slot:"endToBottom"},[t._v("END")])])],1)},[],!1,null,null,null));z.options.__file="resize-app.vue";var $=z.exports;i.a.use(f.a);var H=new f.a({routes:[{path:"/",component:g},{path:"/lazy",component:I},{path:"/resize",component:$}]});i.a.config.productionTip=!1,new i.a({el:"#app",router:H,template:"<App/>",components:{App:u}})},5:function(t,e,a){},6:function(t,e,a){},7:function(t,e,a){}},[[42,1,2]]]);