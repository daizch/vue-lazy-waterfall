webpackJsonp([1],{EP1d:function(t,e){},EsBs:function(t,e){},iXgl:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("7+uW"),a=n("woOf"),o=n.n(a);var l=function(t,e,n){var i,a,l,r,s,c={top:0,right:0,bottom:0,left:0};return a=e,"[object Object]"===Object.prototype.toString.call(a)?(n=e,e=null):n||(n={}),o()(c,n),(i=e?e.getBoundingClientRect():{top:0,right:window.innerWidth||document.documentElement.clientWidth,bottom:window.innerHeight||document.documentElement.clientHeight,left:0}).top-=c.top,i.right+=c.right,i.bottom+=c.bottom,i.left-=c.left,l=t.getBoundingClientRect(),r=i,(s={}).top=Math.max(l.top,r.top),s.bottom=Math.min(l.bottom,r.bottom),s.left=Math.max(l.left,r.left),s.right=Math.min(l.right,r.right),s.bottom>=s.top&&s.right>=s.left};var r={name:"vue-lazy-waterfall",data:function(){return{maxHeight:0,isFinished:!1,beginIndex:0}},props:{items:Array,colNum:{type:Number,default:5},width:{type:Number,default:function(){return window.innerWidth}},itemWidth:{type:Number,default:function(){return parseInt(this.width/this.colNum)}},load:Function,createLazyLoader:Function,diff:{type:Object,default:{bottom:window.innerHeight||document.documentElement.clientHeight}}},watch:{items:function(){this.render()}},mounted:function(){this.render(),this.$on("preloaded",this.preloadedHandler),this.createLazyloadCallback()},beforeDestroy:function(){this.unbindEvents()},methods:{render:function(){this.calcItemsStyle()},scrollHandler:function(){!this.isFinished&&l(this.$refs.loadRef,this.diff)&&this.$emit("load")},createLazyloadCallback:function(){var t,e,n;this.createLazyLoader?this.lazyScrollHandler=this.createLazyLoader(this.$refs.loadRef):this.lazyScrollHandler=(t=this.scrollHandler,e=(e=50)||50,function(){var i=+new Date;(!n||i-n>=e)&&(n=i,t())}),window.addEventListener("scroll",this.lazyScrollHandler.bind(this))},preloadedHandler:function(t){for(var e=this.colNum,n=0;n<t.length;++n){var i=t[n];i._index>=e&&this.updateItemStyle(i)}this.scrollHandler()},unbindEvents:function(){this.lazyScrollHandler&&(window.removeEventListener("scroll",this.lazyScrollHandler),this.lazyScrollHandler=null)},end:function(){this.isFinished=!0,this.unbindEvents()},calcItemsStyle:function(){for(var t=this,e=t.beginIndex,n=t.items,i=n.length-e,a=[],o=function(e){return function(n){n&&(e.$event=n,t.$emit("image-"+n.type,e)),0===(i-=1)&&t.$nextTick(function(){t.$emit("preloaded",a)})}},l=e;l<n.length;l++){var r=n[l],s=new Image;r._index=l,r.src?(s.onload=o(r),s.onerror=o(r),s.src=r.src):o(r),t.calcItemStyle(r,l),a.push(r)}t.beginIndex=t.items.length},updateItemStyle:function(t,e){var n=(e=void 0===e?t._index:e)-this.colNum;if(n>=0){var i=this.$refs["$el_"+n][0],a=this.$refs["$el_"+e][0],o=parseInt(i.style.top)+i.offsetHeight;t._style.top=o+"px",a.style.top=o+"px",this.maxHeight=Math.max(this.maxHeight,o+a.offsetHeight)}},calcItemStyle:function(t,e){var n=e%this.colNum*this.itemWidth;t._style={width:this.itemWidth+"px",left:n+"px",top:"0px"}},clickItemHandler:function(t,e,n){this.$emit("click",{value:t,index:e,$event:n})}}},s={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"vue-lazy-waterfall-wrap",style:{width:t.width+"px"}},[n("ul",{ref:"listRef",staticClass:"vue-lazy-waterfall-list",style:{"padding-top":t.maxHeight+"px"}},[t._l(t.items,function(e,i){return n("li",{ref:"$el_"+i,refInFor:!0,staticClass:"vue-lazy-waterfall-item",style:e._style,on:{click:function(n){t.clickItemHandler(e,i,n)}}},[t._t("default",null,{item:e})],2)}),t._v(" "),n("li",{ref:"loadRef",staticClass:"loading-placeholder"})],2),t._v(" "),t._t("endToBottom")],2)},staticRenderFns:[]};var c=n("VU/8")(r,s,!1,function(t){n("EsBs")},"data-v-73f4adfe",null).exports,d=n("mtWM"),u=n.n(d),h={name:"app",data:function(){return{items:[],group:0,pullDownDistance:0,width:990}},components:{vueLazyWaterfall:c},methods:{loadData:function(){var t=this;u.a.get("./static/mock/data.json?group="+this.group).then(function(e){t.group++,33!==t.group?(e.data.sort(function(){return Math.random()-.5}),t.items=t.items.concat(e.data)):t.$refs.waterfall.end()})},clickFn:function(t){t.value,t.index,t.$event},imageLoad:function(t){t.$event},changeImgArr:function(){var t=this;u.a.get("./static/mock/data-change.json").then(function(e){t.items=e.data})},backToTopHandler:function(){window.scrollTo(0,0)}},created:function(){this.loadData()}},f={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("vueLazyWaterfall",{ref:"waterfall",staticClass:"waterfall-wrap",attrs:{items:t.items,width:t.width,diff:{bottom:2e3}},on:{load:t.loadData,"image-load":t.imageLoad,"image-error":t.imageLoad,click:t.clickFn},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.item;return n("div",{staticClass:"pin-item"},[n("img",{attrs:{src:i.src,alt:""}}),t._v("\n      "+t._s(i.textContent)+"\n    ")])}}])},[n("div",{staticClass:"end-tip",attrs:{slot:"endToBottom"},slot:"endToBottom"},[t._v("end...")])]),t._v(" "),n("div",{staticClass:"back-top",on:{click:t.backToTopHandler}},[t._v("back to top")]),t._v(" "),n("div",{staticStyle:{height:"3000px","background-color":"#00C075"}})],1)},staticRenderFns:[]};var m=n("VU/8")(h,f,!1,function(t){n("EP1d")},null,null).exports;new i.a({el:"#app",template:"<App/>",components:{App:m}})}},["iXgl"]);
//# sourceMappingURL=app.9751592f77ff94458e7d.js.map